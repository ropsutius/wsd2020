SELECT ROUND(AVG((SELECT AVG(c) FROM (VALUES(m.mood), (e.mood)) T (c))), 1) mood
FROM
  (SELECT * FROM evening_reports WHERE email = 'ropsutius@gmail.com'
  AND date = '11-25-2020') e
FULL OUTER JOIN
  (SELECT * FROM morning_reports WHERE email = 'ropsutius@gmail.com'
  AND date = '11-25-2020') m
ON e.date = m.date;


SELECT ROUND(AVG(slp_dur), 1) slp_dur, ROUND(AVG(slp_qlty), 1) slp_qlty,
ROUND(AVG(time_sport), 1) time_sport, ROUND(AVG(time_study), 1) time_study,
ROUND(AVG(eating), 1) eating,
ROUND(AVG((SELECT AVG(c) FROM (VALUES(m.mood), (e.mood)) T (c))), 1) mood
FROM
  (SELECT * FROM evening_reports WHERE email = 'ropsutius@gmail.com'
  AND DATE_TRUNC('MONTH', date) = DATE_TRUNC('MONTH', '2020-11-25')) e
FULL OUTER JOIN
  (SELECT * FROM morning_reports WHERE email = 'ropsutius@gmail.com'
  AND DATE_TRUNC('MONTH', date) = DATE_TRUNC('MONTH', '2020-11-25')) m
ON e.date = m.date;

SELECT *
FROM (SELECT m.date m_date, slp_dur, slp_qlty, m.mood m_mood, m.email m_email, e.date e_date, time_sport, time_study, eating, e.mood e_mood, e.email e_email
FROM morning_reports m
FULL OUTER JOIN evening_reports e
ON m.date = e.date) s
WHERE s.m_email = $1 OR s.e_email = $1;

CREATE UNIQUE INDEX reports_idx ON (SELECT m.date m_date, slp_dur, slp_qlty, m.mood m_mood, m.email m_email, e.date e_date, time_sport, time_study, eating, e.mood e_mood, e.email e_email
FROM morning_reports m
FULL OUTER JOIN evening_reports e
ON m.date = e.date) (m_date, slp_dur, slp_qlty, m_mood, m_email, e_date, time_sport, time_study, eating, e_mood, e_email);
